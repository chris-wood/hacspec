from hacspec.speclib import *
from sha2 import sha224, sha256, sha384, sha512
from sys import exit

# mypy only checks functions that have types. So add an argument :)

def test(msg, expected224, expected256, expected384, expected512,num):
    d224 = bytes.to_hex(sha224(msg))
    d256 = bytes.to_hex(sha256(msg))
    d384 = bytes.to_hex(sha384(msg))
    d512 = bytes.to_hex(sha512(msg))
    if (expected224 == d224 and expected256 == d256 and expected384 == d384 and
        expected512 == d512):
        print("SHA-2 (224/256/384/512) Test "+str(num)+" successful!")
    else:
        print("Test failed!")
        print("Computed: "+d224)
        print("Expected: "+expected224)
        print("Computed: "+d256)
        print("Expected: "+expected256)
        print("Computed: "+d384)
        print("Expected: "+expected384)
        print("Computed: "+d512)
        print("Expected: "+expected512)
        exit(1)

def main(x: int) -> None:
    msg = bytes.from_ints([0x68,0x61,0x63,0x73,0x70,0x65,0x63,0x20,0x72,0x75,0x6c,0x65,0x73])
    expected224 = "803a78c3fe3d0fb7f6b4b7a25cc6f081a195e3d32a96c8532d0b3e3e"
    expected256 = "b37db5ed72c97da3b2579537afbc3261ed3d5a56f57b3d8e5c1019ae35929964"
    expected384 = "8e91095803704de8c45b103cdf42f7bdd9190053e3dce67ec5da564fb5b8b442ec1473d38ed230f0281d6048c3a1f466"
    expected512 = "08b38c5d3108bf7b50821ecff674f921f3206dba462bd2fb236556c86a1cf678f709a920971e7a6b8060088a36a4a554745a1adb6601658548e67a92d48410ae"
    test(msg, expected224, expected256, expected384, expected512,0)

    msg = bytes.from_ints([0x68, 0x61, 0x63, 0x73, 0x70, 0x65, 0x63, 0x20, 0x69, 0x73, 0x20, 0x61, 0x20, 0x70, 0x72, 0x6f, 0x70, 0x6f, 0x73, 0x61, 0x6c, 0x20, 0x66, 0x6f, 0x72, 0x20, 0x61, 0x20, 0x6e, 0x65, 0x77, 0x20, 0x73, 0x70, 0x65, 0x63, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x6c, 0x61, 0x6e, 0x67, 0x75, 0x61, 0x67, 0x65, 0x20, 0x66, 0x6f, 0x72, 0x20, 0x63, 0x72, 0x79, 0x70, 0x74, 0x6f, 0x20, 0x70, 0x72, 0x69, 0x6d, 0x69, 0x74, 0x69, 0x76, 0x65, 0x73, 0x20, 0x74, 0x68, 0x61, 0x74, 0x20, 0x69, 0x73, 0x20, 0x73, 0x75, 0x63, 0x63, 0x69, 0x6e, 0x63, 0x74, 0x2c, 0x20, 0x74, 0x68, 0x61, 0x74, 0x20, 0x69, 0x73, 0x20, 0x65, 0x61, 0x73, 0x79, 0x20, 0x74, 0x6f, 0x20, 0x72, 0x65, 0x61, 0x64, 0x20, 0x61, 0x6e, 0x64, 0x20, 0x69, 0x6d, 0x70, 0x6c, 0x65, 0x6d, 0x65, 0x6e, 0x74, 0x2c, 0x20, 0x61, 0x6e, 0x64, 0x20, 0x74, 0x68, 0x61, 0x74, 0x20, 0x6c, 0x65, 0x6e, 0x64, 0x73, 0x20, 0x69, 0x74, 0x73, 0x65, 0x6c, 0x66, 0x20, 0x74, 0x6f, 0x20, 0x66, 0x6f, 0x72, 0x6d, 0x61, 0x6c, 0x20, 0x76, 0x65, 0x72, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x2e])
    expected224 = '3deb8ac564c6c8f6b8058df7a6e4dceffe702ed2dc311bef1ad59b37'
    expected256 = '348ef044446d56e05210361af5a258588ad31765f446bf4cb3b67125a187a64a'
    expected384 = '57d5728d332f6e6a739343ad22eadf38b6723806925d4d0ec6c65bbe5771d34e5ce4c612df0c0e503bbc7cc7aa9df95c'
    expected512 = 'df847d1485802eafdda5bfb4b6a063ffa3f70285c8125842bc5fac5e778343724dd3edc71208c57b6b424e7c8ee8dcc0765ea69ecc73fee0ce17d62784bcc811'
    test(msg, expected224, expected256, expected384, expected512,1)

if __name__ == "__main__":
    main(0)
